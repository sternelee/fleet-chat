# Fleet Chat 拖拽安装插件功能

Fleet Chat 现在支持通过拖拽 `.fcp` 文件到应用程序窗口来安装插件，提供了更加便捷的插件安装体验。

## 功能特点

### 1. 全局拖拽支持
- 可以将 `.fcp` 文件拖拽到 Fleet Chat 窗口的任何位置
- 自动识别有效的插件文件
- 提供视觉反馈和进度指示

### 2. 专用拖拽区域
- 在插件管理页面提供了专门的拖拽区域
- 支持点击浏览文件
- 显示拖拽状态和文件信息

### 3. 智能文件处理
- 自动过滤非 `.fcp` 文件
- 支持批量拖拽多个插件文件
- 实时显示安装进度和状态

## 使用方法

### 方法一：全局拖拽（推荐）
1. 获取 `.fcp` 插件文件
2. 直接将文件拖拽到 Fleet Chat 窗口的任意位置
3. 释放鼠标即可开始安装

### 方法二：插件管理页面拖拽
1. 打开 Fleet Chat
2. 进入设置 → 插件页面
3. 将 `.fcp` 文件拖拽到"安装新插件"区域
4. 或点击该区域浏览文件

### 方法三：传统安装方式
1. 在插件管理页面点击"安装插件"按钮
2. 输入插件文件的 URL 或本地路径
3. 点击"安装"按钮

## 拖拽界面说明

### 拖拽悬停状态
当拖拽有效文件到窗口时，会显示：
- 半透明黑色遮罩
- "安装插件"提示
- 文件图标和释放提示
- 拖拽文件列表（如果正在处理）

### 安装进度
- ⏳ 处理中：显示进度条和"Processing..."状态
- ✅ 成功：显示"Installed"状态和成功提示
- ❌ 失败：显示"Failed"状态和错误信息

### 拖拽区域状态
- 默认：显示拖拽提示图标和文本
- 悬停：边框高亮，背景色变化
- 拖拽中：显示文件列表和处理状态

## 支持的文件类型

### 有效文件
- `.fcp` - Fleet Chat 插件包文件

### 无效文件
- 其他扩展名会被自动忽略
- 拖拽无效文件时不会触发安装流程

## 安全特性

1. **文件验证**
   - 自动验证文件扩展名
   - 检查文件格式有效性
   - 验证插件清单结构

2. **隔离执行**
   - 插件在沙箱环境中运行
   - 权限控制和限制
   - 安全策略检查

3. **错误处理**
   - 详细的错误提示
   - 失败文件不会影响其他文件
   - 自动回滚机制

## 技术实现

### 组件结构
```
src/components/
├── drop-zone.ts           # 专用拖拽区域组件
├── global-drop-handler.ts  # 全局拖拽处理组件
└── plugin-manager-ui.ts   # 插件管理界面
```

### 关键功能
1. **事件监听**：监听全局 `dragenter`, `dragover`, `dragleave`, `drop` 事件
2. **文件过滤**：只接受 `.fcp` 扩展名的文件
3. **状态管理**：管理拖拽状态、文件列表、安装进度
4. **视觉反馈**：提供拖拽悬停、处理进度、结果状态的视觉反馈

### 浏览器兼容性
- Chrome/Edge 88+
- Firefox 90+
- Safari 14+

### Tauri 集成
- 支持本地文件路径访问
- 原生文件对话框集成
- 桌面应用优化

## 故障排除

### 拖拽不工作
1. 确保文件扩展名是 `.fcp`
2. 尝试刷新页面后重试
3. 检查浏览器是否支持拖拽 API

### 安装失败
1. 检查插件文件是否损坏
2. 查看控制台错误信息
3. 确认插件版本兼容性

### 文件未识别
1. 确认文件扩展名正确（`.fcp`）
2. 检查文件是否完整
3. 尝试重新下载或生成插件文件

## 最佳实践

1. **批量安装**：可以同时拖拽多个 `.fcp` 文件进行批量安装
2. **快速验证**：拖拽前可以先检查文件大小和完整性
3. **空间清理**：安装完成后可以清理临时文件
4. **版本管理**：使用语义化版本控制插件更新

## 更新日志

### v1.0.0 (2024-12-22)
- ✨ 初始版本发布
- 🎯 支持全局拖拽安装
- 📁 专用拖拽区域
- 🔄 批量文件处理
- 💬 详细状态反馈